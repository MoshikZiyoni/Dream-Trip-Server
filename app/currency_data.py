currency_data_data = {
'AED': ('United Arab Emirates Dirham', 0.27),
'AFN': ('Afghan Afghani', 0.012),
'ALL': ('Albanian Lek', 0.0090),
'AMD': ('Armenian Dram', 0.0019),
'ANG': ('Netherlands Antillean Guilder', 0.56),
'AOA': ('Angolan Kwanza', 0.0018),
'ARS': ('Argentine Peso', 0.0069),
'AUD': ('Australian Dollar', 0.69),
'AWG': ('Aruban Florin', 0.56),
'AZN': ('Azerbaijani Manat', 0.59),
'BAM': ('Bosnia-Herzegovina Convertible Mark', 0.57),
'BBD': ('Barbadian Dollar', 0.50),
'BDT': ('Bangladeshi Taka', 0.011),
'BGN': ('Bulgarian Lev', 0.55),
'BHD': ('Bahraini Dinar', 2.65),
'BIF': ('Burundian Franc', 0.00052),
'BMD': ('Bermudan Dollar', 1.0),
'BND': ('Brunei Dollar', 0.73),
'BOB': ('Bolivian Boliviano', 0.14),
'BRL': ('Brazilian Real', 0.19),
'BSD': ('Bahamian Dollar', 1.0),
'BTN': ('Bhutanese Ngultrum', 0.012),
'BWP': ('Botswanan Pula', 0.072),
'BYN': ('Belarusian Ruble', 0.38),
'BZD': ('Belize Dollar', 0.49),
'CAD': ('Canadian Dollar', 0.77),
'CDF': ('Congolese Franc', 0.00050),
'CHF': ('Swiss Franc', 1.06),
'CLP': ('Chilean Peso', 0.0012),
'CNY': ('Chinese Yuan', 0.15),
'COP': ('Colombian Peso', 0.00022),
'CRC': ('Costa Rican Colón', 0.0014),
'CUC': ('Cuban Convertible Peso', 1.0),
'CUP': ('Cuban Peso', 0.039),
'CVE': ('Cape Verdean Escudo', 0.0090),
'CZK': ('Czech Republic Koruna', 0.040),
'DJF': ('Djiboutian Franc', 0.0056),
'DKK': ('Danish Krone', 0.14),
'DOP': ('Dominican Peso', 0.016),
'DZD': ('Algerian Dinar', 0.0077),
'EGP': ('Egyptian Pound', 0.051),
'ERN': ('Eritrean Nakfa', 0.065),
'ETB': ('Ethiopian Birr', 0.028),
'EUR': ('Euro', 1.02),
'FJD': ('Fijian Dollar', 0.44),
'FKP': ('Falkland Islands Pound', 1.22),
'GBP': ('British Pound', 1.21),
'GEL': ('Georgian Lari', 0.38),
'GGP': ('Guernsey Pound', 1.22),
'GHS': ('Ghanaian Cedi', 0.11),
'GIP': ('Gibraltar Pound', 1.22),
'GMD': ('Gambian Dalasi', 0.018),
'GNF': ('Guinean Franc', 0.000095),
'GTQ': ('Guatemalan Quetzal', 0.13),
'GYD': ('Guyanaese Dollar', 0.0047),
'HKD': ('Hong Kong Dollar', 0.13),
'HNL': ('Honduran Lempira', 0.041),
'HRK': ('Croatian Kuna', 0.14),
'HTG': ('Haitian Gourde', 0.0090),
'HUF': ('Hungarian Forint', 0.0024),
'IDR': ('Indonesian Rupiah', 0.000065),
'ILS': ('Israeli New Sheqel', 0.29),
'IMP': ('Manx Pound', 1.22),
'INR': ('Indian Rupee', 0.012),
'IQD': ('Iraqi Dinar', 0.00069),
'IRR': ('Iranian Rial', 0.000023),
'ISK': ('Icelandic Króna', 0.0073),
'JEP': ('Jersey Pound', 1.22),
'JMD': ('Jamaican Dollar', 0.0061),
'JOD': ('Jordanian Dinar', 1.41),
'JPY': ('Japanese Yen', 0.0074),
'KES': ('Kenyan Shilling', 0.0083),
'KGS': ('Kyrgystani Som', 0.012),
'KHR': ('Cambodian Riel', 0.00024),
'KMF': ('Comorian Franc', 0.0020),
'KPW': ('North Korean Won', 0.0030),
'KRW': ('South Korean Won', 0.00075),
'KWD': ('Kuwaiti Dinar', 3.27),
'KYD': ('Cayman Islands Dollar', 1.22),
'KZT': ('Kazakhstani Tenge', 0.0017),
'LAK': ('Laotian Kip', 0.000087),
'LBP': ('Lebanese Pound', 0.00065),
'LKR': ('Sri Lankan Rupee', 0.0028),
'LRD': ('Liberian Dollar', 0.0057),
'LSL': ('Lesotho Loti', 0.057),
'LYD': ('Libyan Dinar', 1.43),
'MAD': ('Moroccan Dirham', 0.093),
'MDL': ('Moldovan Leu', 0.052),
'MGA': ('Malagasy Ariary', 0.00025),
'MKD': ('Macedonian Denar', 0.016),
'MMK': ('Myanma Kyat', 0.00049),
'MNT': ('Mongolian Tugrik', 0.00031),
'MOP': ('Macanese Pataca', 0.12),
'MRU': ('Mauritanian Ouguiya', 0.023),
'MUR': ('Mauritian Rupee', 0.024),
'MVR': ('Maldivian Rufiyaa', 0.065),
'MWK': ('Malawian Kwacha', 0.0010),
'MXN': ('Mexican Peso', 0.049),
'MYR': ('Malaysian Ringgit', 0.22),
'MZN': ('Mozambican Metical', 0.015),
'NAD': ('Namibian Dollar', 0.057),
'NGN': ('Nigerian Naira', 0.0022),
'NIO': ('Nicaraguan Córdoba', 0.027),
'NOK': ('Norwegian Krone', 0.10),
'NPR': ('Nepalese Rupee', 0.0078),
'NZD': ('New Zealand Dollar', 0.61),
'OMR': ('Omani Rial', 2.60),
'PAB': ('Panamanian Balboa', 1.0),
'PEN': ('Peruvian Nuevo Sol', 0.25),
'PGK': ('Papua New Guinean Kina', 0.28),
'PHP': ('Philippine Peso', 0.018),
'PKR': ('Pakistani Rupee', 0.0045),
'PLN': ('Polish Zloty', 0.21),
'PYG': ('Paraguayan Guarani', 0.00014),
'QAR': ('Qatari Rial', 0.27),
'RON': ('Romanian Leu', 0.21),
'RSD': ('Serbian Dinar', 0.0085),
'RUB': ('Russian Ruble', 0.016),
'RWF': ('Rwandan Franc', 0.00089),
'SAR': ('Saudi Riyal', 0.27),
'SBD': ('Solomon Islands Dollar', 0.12),
'SCR': ('Seychellois Rupee', 0.059),
'SDG': ('Sudanese Pound', 0.0020),
'SEK': ('Swedish Krona', 0.091),
'SGD': ('Singapore Dollar', 0.73),
'SHP': ('Saint Helena Pound', 1.22),
'SLL': ('Sierra Leonean Leone', 0.000092),
'SOS': ('Somali Shilling', 0.0011),
'SRD': ('Surinamese Dollar', 0.057),
'SSP': ('South Sudanese Pound', 0.0019),
'STD': ('São Tomé and Príncipe Dobra', 0.041),
'SYP': ('Syrian Pound', 0.00039),
'SZL': ('Swazi Lilangeni', 0.057),
'THB': ('Thai Baht', 0.027),
'TJS': ('Tajikistani Somoni', 0.098),
'TMT': ('Turkmenistan Manat', 0.29),
'TND': ('Tunisian Dinar', 0.33),
'TOP': ('Tongan Paʻanga', 0.41),
'TRY': ('Turkish Lira', 0.054),
'TTD': ('Trinidad and Tobago Dollar', 0.15),
'TWD': ('New Taiwan Dollar', 0.033),
'TZS': ('Tanzanian Shilling', 0.00043),
'UAH': ('Ukrainian Hryvnia', 0.027),
'UGX': ('Ugandan Shilling', 0.00026),
'USD': ('United States Dollar', 1.0),
'UYU': ('Uruguayan Peso', 0.024),
'UZS': ('Uzbekistan Som', 0.000092),
'VES': ('Venezuelan Bolívar Soberano', 0.048),
'VND': ('Vietnamese Dong', 0.000043),
'VUV': ('Vanuatu Vatu', 0.0087),
'WST': ('Samoan Tala', 0.37),
'XAF': ('CFA Franc BEAC', 0.0015),
'XCD': ('East Caribbean Dollar', 0.37),
'XOF': ('CFA Franc BCEAO', 0.0015),
'XPF': ('CFP Franc', 0.0090),
'YER': ('Yemeni Rial', 0.0040),
'ZMW': ('Zambian Kwacha', 0.057),
'ZWL': ('Zimbabwean Dollar', 0.00027),
'€': ('Euro', 1.02),'£': ('Pound Sterling', 1.20),
'$': ('US Dollar', 1),  
'¥': ('Japanese Yen', 0.0074),
'yen': ('yen', 0.0074),
'₹': ('Indian Rupee', 0.012),
'฿': ('Thai Baht', 0.028),
'R$': ('Brazilian Real', 0.19),
'MX$': ('Mexican Peso', 0.048),
'CA$': ('Canadian Dollar', 0.73),
'AU$': ('Australian Dollar', 0.69),
'CHF': ('Swiss Franc', 1.09),
'R': ('South African Rand', 0.057)

}

import re
def calculate_total_price_attractions(attraction):
    total=0
    try:
        price = attraction['real_price']
        print ("price: ",price)
        pattern = r'\b(?:Free|free|unavailable)\b'
        # Check if the pattern matches the input string
        if re.search(pattern, price) and not re.search(r'\d', price):
            return 0
        currency = ''
        amount = ''

        # Look for currency code 
        words = price.split(' ')
        for word in words:
            try:
                if len(word) == 3 and word.lower() in currency_data_data:
                    
                    currency = word.upper()
                    print(currency)
            except:
                print('NOOOOOOOOOOOO')

        try:
            match = re.search(r'([\d,.]+)', price)
            amount1 = match.group(1).replace(',', '')
            if 'yen' in price or 'YEN' in price:
                        japn_currency='yen'
                        rate1 = currency_data_data[japn_currency][1]
                        usd_amount = float(amount1.replace(',', '')) * rate1
                        total += usd_amount
                        return total
            if match:
                numerical = re.search(r'(\d+(?:,?\d+)*)\s?([€$£¥])', price)
                
                if '$' in price:
                    usd_amount = float(amount1.replace(',', ''))
                    total += usd_amount
                    return total
 
                try:
                    
                    new_currency1 = numerical.group(2)
                    # print ("new_currency:   ",new_currency)
                    rate1 = currency_data_data[new_currency1][1]
                    usd_amount = float(amount1.replace(',', '')) * rate1
                    total += usd_amount
                    return total

                except:
                    pass
                if amount1:
                    currency123=currency.lower()
                    rate12 = currency_data_data[currency123][1]
                    usd_amount123 = float(amount1.replace(',', '')) * rate12
                    total += usd_amount123
                    return total

                
        except:
            print ('fall in 312')


    # if currency and amount:
        try:
            try:
                
                price_match = re.search(r'([\d,.]+)\s?([A-Z]{3})?', price)
                if price_match:
                    amount = price_match.group(1)
                    if '$' in price:
                        usd_amount = float(amount.replace(',', ''))
                        total += usd_amount
                        return total

                    currency = price_match.group(2)
            except:
                pass
            try:
                currency = currency.lower()
            except:
                pass

            rate = currency_data_data[currency][1]
            usd_amount = float(amount.replace(',', '')) * rate
            total += usd_amount
            return total

        except:
            print ('fall in 336')
            pass
        numerical_values = re.search(r'(\d+(?:,?\d+)*)\s?([€$£¥])?', price)
        if numerical_values:
            amount = numerical_values.group(1)
            
            currency = numerical_values.group(2)
            # print ("amount:   ",amount,currency)
            rate = currency_data_data[currency][1]
            usd_amount = float(amount.replace(',', '')) * rate
            total += usd_amount
            return total

        if new_currency1 == 'USD' or new_currency1 == '$':
            total += float(amount)
        else:
            new_currency = (re.sub(r'\d', '', currency))
            match_for_symbols = re.search(r'([€$£¥])', new_currency)
            match_for_symbols2 = re.search(r'([€$£¥])', price)
            if match_for_symbols:
                symbol = match_for_symbols.group(1)
                rate = currency_data_data[symbol][1]
                usd_amount = float(amount.replace(',', '')) * rate
                total += usd_amount
            if match_for_symbols==None:
                
                symbol = match_for_symbols2.group(1)
                rate = currency_data_data[symbol][1]
                usd_amount = float(amount.replace(',', '')) * rate
                total += usd_amount
                return total

        
    except Exception as e:
        print ('ERROR',e)